---
title: "Simulation_Transform"
author: "Jose Tamez"
date: "`r Sys.Date()`"
output:
  html_document: 
    toc: yes
    fig_caption: yes
    number_sections: yes
  word_document: 
    reference_docx: WordStyle_FRESA.docx
    toc: yes
    fig_caption: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(collapse = TRUE, warning = FALSE, message = FALSE,comment = "#>")
```



# Validating ILAA as metod to recover the transformation matrix structure

We will simulate a set of sparse random transformations, and we test if ILAA is able to recover the inverse transformation
The data will consist of a set of N random variables half Gaussian, half with uniform distribution.
The transformation matrix will only create a set of 10 correlated variables

### Loading the libraries

```{r}
library("FRESA.CAD")
library(entropy)
library(psych)
library(whitening)
library("vioplot")

op <- par(no.readonly = TRUE)
pander::panderOptions('digits', 3)
pander::panderOptions('table.split.table', 400)
pander::panderOptions('keep.trailing.zeros',TRUE)
source("~/GitHub/LatentBiomarkers/SimulatedDataFunctions.R")

```

### Simulation parameters

```{r}
NUmberofSimulations = 100

## Simulation parameters
NumOfObs  <- 1000
NumOfCorFeatures <- 40
randomToCorrelRatio <- 1
pOfnoZero <- 0.25

## ILAA parameters
thr <- 0.40
method <- "pearson"
type <- "LM"

```



## The Data

```{r}

syndata <- SyntheticData(NumOfObs=NumOfObs/10,
                         NumOfCorFeatures=NumOfCorFeatures/4,
                         randomToCorrelRatio=0,
                         pOfnoZero=0.35,
                         noiseLevel=0.2)

plot(syndata$data)
print(syndata$rotMatrix)

```


### ILAA

```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}

IdeT <- ILAA(syndata$data,thr=thr,verbose=TRUE,bootstrap=30)
rmat <- attr(IdeT,"UPLTM")
print(rmat)

falsedisc <- str_detect(rownames(rmat),"R")
sum(falsedisc)
rmat <- rmat[!falsedisc,]
falsedisc <- str_detect(colnames(rmat),"R")
sum(falsedisc)
rmat <- rmat[,!falsedisc]

rnrotmat <- syndata$rotMatrix
colnames(rnrotmat) <- str_remove_all(colnames(rnrotmat),"La_")
trueUsedFeatures <- rnrotmat != 0
trueUsedFeatures <- 1*(trueUsedFeatures | t(trueUsedFeatures))

rnrmat <- rmat
colnames(rnrmat) <- str_remove_all(colnames(rnrmat),"La_")
detectedFeatures <- rnrmat != 0
detectedFeatures <- 1*(detectedFeatures | t(detectedFeatures))

aux <- detectedFeatures
detectedFeatures <- 0*trueUsedFeatures
for (rn in rownames(aux))
{
  for (cn in colnames(aux))
  {
    detectedFeatures[rn,cn] <- aux[rn,cn];
  }
}
diag(detectedFeatures) <- 1.0

pairAsosTable <- NULL
for (rn in c(1:(nrow(trueUsedFeatures)-1)))
{
  for (cn in c((rn+1):ncol(trueUsedFeatures)))
  {
    pairAsosTable <- rbind(pairAsosTable,c(detectedFeatures[rn,cn],trueUsedFeatures[rn,cn]))
  }
}
colnames(pairAsosTable) <- c("Estimated","True")
pairAsosTable <- as.data.frame(pairAsosTable)
pander::pander(table(pairAsosTable))
npairAsosTable <- as.data.frame(pairAsosTable==0)
pair_Analysis <- epiR::epi.tests(table(npairAsosTable))
sen <- pair_Analysis$detail[3,2]
spe <- pair_Analysis$detail[4,2]
acc <- pair_Analysis$detail[5,2]

sen <- sum((pairAsosTable$Estimated==pairAsosTable$True)&pairAsosTable$True)/sum(pairAsosTable$True)
spe <- sum((pairAsosTable$Estimated==pairAsosTable$True)&(pairAsosTable$True==0))/sum(pairAsosTable$True==0)
acc <- sum(pairAsosTable$Estimated==pairAsosTable$True)/nrow(pairAsosTable)
pander::pander(c(Accuracy=acc,Sensitivity=sen,Specificity=spe))
```



### Heat map

```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}

rawCor <- cor(syndata$onlyRotatedData)

  gplots::heatmap.2(abs(rawCor),
                    trace = "none",
                    mar = c(5,5),
                    Rowv = FALSE,
                    Colv = FALSE,
                    col=rev(heat.colors(5)),
                    main = "Pearson Correlation",
                    dendrogram = "none",
                    cexRow = 0.75,
                    cexCol = 0.75,
                    key.title=NA,
                    key.xlab="Coefficients",
                    xlab="Feature", ylab="Feature")

```


### Heat map true rotation

```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}

gplots::heatmap.2(trueUsedFeatures,
                    trace = "none",
                    mar = c(5,5),
                    Rowv = FALSE,
                    Colv = FALSE,
                    col=rev(heat.colors(5)),
                    main = "True transformation",
                    dendrogram = "none",
                    cexRow = 0.75,
                    cexCol = 0.75,
                    key.title=NA,
                    key.xlab="Coefficients",
                    xlab="Feature", ylab="Feature")

```

### Heat map estimated rotation

```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}

gplots::heatmap.2(detectedFeatures,
                    trace = "none",
                    mar = c(5,5),
                    Rowv = FALSE,
                    Colv = FALSE,
                    col=rev(heat.colors(5)),
                    main = "ILAA transformation",
                    dendrogram = "none",
                    cexRow = 0.75,
                    cexCol = 0.75,
                    key.title=NA,
                    key.xlab="Coefficients",
                    xlab="Feature", ylab="Feature")

```

## Lets run simulations

### Testing the differences in parameters
```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}



falseDiscoveryT <- numeric(NUmberofSimulations)
DiscoveryAccuracyT <- numeric(NUmberofSimulations)
DiscoverySenT <- numeric(NUmberofSimulations)
DiscoverySpeT <- numeric(NUmberofSimulations)
trainCorT <- numeric(NUmberofSimulations)
testCorT <- numeric(NUmberofSimulations)

falseDiscoveryB <- numeric(NUmberofSimulations)
DiscoveryAccuracyB <- numeric(NUmberofSimulations)
DiscoverySenB <- numeric(NUmberofSimulations)
DiscoverySpeB <- numeric(NUmberofSimulations)
trainCorB <- numeric(NUmberofSimulations)
testCorB <- numeric(NUmberofSimulations)

falseDiscoveryST <- numeric(NUmberofSimulations)
DiscoveryAccuracyST <- numeric(NUmberofSimulations)
DiscoverySenST <- numeric(NUmberofSimulations)
DiscoverySpeST <- numeric(NUmberofSimulations)
trainCorST <- numeric(NUmberofSimulations)
testCorST <- numeric(NUmberofSimulations)

falseDiscoverySB <- numeric(NUmberofSimulations)
DiscoveryAccuracySB <- numeric(NUmberofSimulations)
DiscoverySenSB <- numeric(NUmberofSimulations)
DiscoverySpeSB <- numeric(NUmberofSimulations)
trainCorSB <- numeric(NUmberofSimulations)
testCorSB <- numeric(NUmberofSimulations)

overlapTF <- numeric(NUmberofSimulations)
overlapSTSB <- numeric(NUmberofSimulations)
overlapTST <- numeric(NUmberofSimulations)
overlapFST <- numeric(NUmberofSimulations)
overlapTSB <- numeric(NUmberofSimulations)
overlapFSB <- numeric(NUmberofSimulations)


i = 1
for (i in 1:NUmberofSimulations)
{
  cat(".")
  if (i %% 10 == 0) cat("\n")
  syndata <- SyntheticData(NumOfObs=NumOfObs,NumOfCorFeatures=NumOfCorFeatures,randomToCorrelRatio=randomToCorrelRatio,pOfnoZero=-pOfnoZero)
  
  trainSample <- sample(NumOfObs,NumOfObs/2)
  cat("T")

  evalILAAPear <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                 testdata=syndata$data[-trainSample,],
                                 trueRotation=syndata$rotMatrix,
                                 method=method,
                                 Bootstrap=0,
                                 thr=thr)

  trainCorT[i] <- evalILAAPear$trainCorrelation
  testCorT[i] <- evalILAAPear$testCorrelation
  falseDiscoveryT[i] <- evalILAAPear$falseDiscovery
  DiscoveryAccuracyT[i] <- evalILAAPear$DiscoveryAccuracy
  DiscoverySenT[i] <- evalILAAPear$DiscoverySen
  DiscoverySpeT[i] <- evalILAAPear$DiscoverySpe
  

  cat("F")
  evalILAABoot <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                 testdata=syndata$data[-trainSample,],
                                 trueRotation=syndata$rotMatrix,
                                 method=method,
                                 Bootstrap=30,
                                 thr=thr)

  trainCorB[i] <- evalILAABoot$trainCorrelation
  testCorB[i] <- evalILAABoot$testCorrelation
  falseDiscoveryB[i] <- evalILAABoot$falseDiscovery
  DiscoveryAccuracyB[i] <- evalILAABoot$DiscoveryAccuracy
  DiscoverySenB[i] <- evalILAABoot$DiscoverySen
  DiscoverySpeB[i] <- evalILAABoot$DiscoverySpe

  cat("t")
  evalILAASpearman <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                 testdata=syndata$data[-trainSample,],
                                 trueRotation=syndata$rotMatrix,
                                 method="spearman",
                                 Bootstrap=0,
                                 thr=thr)
  
  trainCorST[i] <- evalILAASpearman$trainCorrelation
  testCorST[i] <- evalILAASpearman$testCorrelation
  falseDiscoveryST[i] <- evalILAASpearman$falseDiscovery
  DiscoveryAccuracyST[i] <- evalILAASpearman$DiscoveryAccuracy
  DiscoverySenST[i] <- evalILAASpearman$DiscoverySen
  DiscoverySpeST[i] <- evalILAASpearman$DiscoverySpe

  cat("f")
  evalILAASpearmanBoot <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                 testdata=syndata$data[-trainSample,],
                                 trueRotation=syndata$rotMatrix,
                                 method="spearman",
                                 Bootstrap=5,
                                 thr=thr)
  
  trainCorSB[i] <- evalILAASpearmanBoot$trainCorrelation
  testCorSB[i] <- evalILAASpearmanBoot$testCorrelation
  falseDiscoverySB[i] <- evalILAASpearmanBoot$falseDiscovery
  DiscoveryAccuracySB[i] <- evalILAASpearmanBoot$DiscoveryAccuracy
  DiscoverySenSB[i] <- evalILAASpearmanBoot$DiscoverySen
  DiscoverySpeSB[i] <- evalILAASpearmanBoot$DiscoverySpe


  sizeMat <- nrow(evalILAAPear$UsedBetas)^2
  overlapTF[i] <- sum(evalILAAPear$UsedBetas == evalILAABoot$UsedBetas)/sizeMat
  overlapSTSB[i] <- sum(evalILAASpearman$UsedBetas == evalILAASpearmanBoot$UsedBetas)/sizeMat
  overlapTST[i] <- sum(evalILAAPear$UsedBetas == evalILAASpearman$UsedBetas)/sizeMat
  overlapFST[i] <- sum(evalILAABoot$UsedBetas == evalILAASpearman$UsedBetas)/sizeMat
  overlapTSB[i] <- sum(evalILAAPear$UsedBetas == evalILAASpearmanBoot$UsedBetas)/sizeMat
  overlapFSB[i] <- sum(evalILAABoot$UsedBetas == evalILAASpearmanBoot$UsedBetas)/sizeMat
  
}
par(cex=0.8,cex.main=0.85,cex.axis=0.9)

boxplot(list(Pearson_1=DiscoveryAccuracyT,Pearson_2=DiscoveryAccuracyB,Spearman_1=DiscoveryAccuracyST,Spearman_2=DiscoveryAccuracySB),
        main="Accuracy",ylab="Accuracy")
boxplot(list(Pearson_0=DiscoverySenT,Pearson_P=DiscoverySenB,Spearman_0=DiscoverySenST,Spearman_P=DiscoverySenSB),
        main="Sensitivity",ylab="Sensitivity")
boxplot(list(Pearson_0=DiscoverySpeT,Pearson_P=DiscoverySpeB,Spearman_0=DiscoverySpeST,Spearman_P=DiscoverySpeSB),
        main="Specificity",ylab="Specificity")
boxplot(list(P1_P2=overlapTF,
             S1_S2=overlapSTSB,
             P1_S1=overlapTST,
             P2_S1=overlapFST,
             P1_S2=overlapTSB,
             P2_S2=overlapFSB),
        main="Overlap",
        ylab="Overlap"
        )
boxplot(list(Pearson_1=trainCorT,Pearson_2=trainCorB,Spearman_1=trainCorST,Spearman_2=trainCorSB),
        main="Train Correlation",
        ylab="Correlation")
boxplot(list(Pearson_1=testCorT,Pearson_2=testCorB,Spearman_1=testCorST,Spearman_2=testCorSB),
        main="Test Correlation",
        ylab="Correlation")


```


### Testing the effect of the threshold
```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}

thrvals <- c(0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90)

randomToCorrelRatio <- 1
NUmberofSimulations <- 30

falseDiscovery <- matrix(0,nrow=NUmberofSimulations,ncol=length(thrvals))
DiscoveryAccuracy <- falseDiscovery
DiscoverySen <- falseDiscovery
DiscoverySpe <- falseDiscovery
trainCor <- falseDiscovery
testCor <- falseDiscovery
rotSparcity <- falseDiscovery

trueSpacity <- numeric(NUmberofSimulations)
i = 1
for (i in 1:NUmberofSimulations)
{
  cat(".")
  if (i %% 10 == 0) cat("\n")
  syndata <- SyntheticData(NumOfObs=NumOfObs,
                           NumOfCorFeatures=NumOfCorFeatures,
                           randomToCorrelRatio=randomToCorrelRatio,
                           pOfnoZero=-pOfnoZero)
  

  trueSpacity[i] <- sum(syndata$rotMatrix==0)/(NumOfCorFeatures^2)
  trainSample <- sample(NumOfObs,NumOfObs/2)
  cn <- 1;
  for (thr in thrvals)
  {
    cat("T")
    evalILAA <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                   testdata=syndata$data[-trainSample,],
                                   trueRotation=syndata$rotMatrix,
                                   method=method,
                                   Bootstrap=0,
                                   thr=thr)
    trainCor[i,cn] <- evalILAA$trainCorrelation
    testCor[i,cn] <- evalILAA$testCorrelation
    falseDiscovery[i,cn] <- evalILAA$falseDiscovery
    DiscoveryAccuracy[i,cn] <- evalILAA$DiscoveryAccuracy
    DiscoverySen[i,cn] <- evalILAA$DiscoverySen
    DiscoverySpe[i,cn] <- evalILAA$DiscoverySpe

    rotSparcity[i,cn] <- sum(evalILAA$UPLTM==0)/(ncol(evalILAA$UPLTM)^2)
    cn <- cn + 1;
  }
}
DiscoveryAccuracy <- as.data.frame(DiscoveryAccuracy)
colnames(DiscoveryAccuracy) <- paste("At_",thrvals,sep="")

DiscoverySen <- as.data.frame(DiscoverySen)
colnames(DiscoverySen) <- colnames(DiscoveryAccuracy)
DiscoverySpe <- as.data.frame(DiscoverySpe)
colnames(DiscoverySpe) <- colnames(DiscoveryAccuracy)

trainCor <- as.data.frame(trainCor)
colnames(trainCor) <- colnames(DiscoveryAccuracy)

testCor <- as.data.frame(testCor)
colnames(testCor) <- colnames(DiscoveryAccuracy)

falseDiscovery <- as.data.frame(falseDiscovery)
colnames(falseDiscovery) <- colnames(DiscoveryAccuracy)


rotSparcity <- as.data.frame(rotSparcity)
colnames(rotSparcity) <- colnames(DiscoveryAccuracy)
rotSparcity <- cbind(rotSparcity,True=trueSpacity)

par(cex=0.8,cex.main=0.85,cex.axis=0.9)

boxplot(DiscoveryAccuracy,main="Accuracy",ylab="Accuracy",ylim=c(0.5,1))
boxplot(DiscoverySen,main="Sensitivity",ylab="Sensitivity",ylim=c(0,1))
boxplot(DiscoverySpe,main="Specificity",ylab="Specificity",ylim=c(0,1))
boxplot(0.5*(DiscoverySpe+DiscoverySen),main="Balanced Accuracy",ylab="BACC",ylim=c(0.5,1))
boxplot(falseDiscovery,main="False Discoveries",ylab="Number of False Discoveries")
boxplot(rotSparcity,main="Rotation Matrix Sparcity",ylab="Sparcity")

ylim <- c(thrvals[1],thrvals[length(thrvals)])
boxplot(trainCor,main="Train Correlation",ylab="Correlation")
lines(c(1,length(thrvals)),ylim)
boxplot(testCor,main="Test Correlation",ylab="Correlation",ylim=ylim)
lines(c(1,length(thrvals)),ylim)

```


### Testing the effect of the threshold with bootstrap

```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}


falseDiscoveryB <- matrix(0,nrow=NUmberofSimulations,ncol=length(thrvals))
DiscoveryAccuracyB <- falseDiscoveryB
DiscoverySenB <- falseDiscoveryB
DiscoverySpeB <- falseDiscoveryB
trainCorB <- falseDiscoveryB
testCorB <- falseDiscoveryB
rotSparcityB <- falseDiscoveryB

trueSpacityB <- numeric(NUmberofSimulations)
i = 1
for (i in 1:NUmberofSimulations)
{
  cat(".")
  if (i %% 10 == 0) cat("\n")

  syndata <- SyntheticData(NumOfObs=NumOfObs,
                           NumOfCorFeatures=NumOfCorFeatures,
                           randomToCorrelRatio=randomToCorrelRatio,
                           pOfnoZero= -pOfnoZero)
  
  trueSpacity[i] <- sum(syndata$rotMatrix==0)/(NumOfCorFeatures^2)
  trainSample <- sample(NumOfObs,NumOfObs/2)
  cn <- 1;
  for (thr in thrvals)
  {
    cat("T")
    evalILAA <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                   testdata=syndata$data[-trainSample,],
                                   trueRotation=syndata$rotMatrix,
                                   method=method,
                                   Bootstrap=10,
                                   thr=thr)
    
    trainCorB[i,cn] <- evalILAA$trainCorrelation
    testCorB[i,cn] <- evalILAA$testCorrelation
    falseDiscoveryB[i,cn] <- evalILAA$falseDiscovery
    DiscoveryAccuracyB[i,cn] <- evalILAA$DiscoveryAccuracy
    DiscoverySenB[i,cn] <- evalILAA$DiscoverySen
    DiscoverySpeB[i,cn] <- evalILAA$DiscoverySpe

    rotSparcityB[i,cn] <- sum(evalILAA$UPLTM==0)/(ncol(evalILAA$UPLTM)^2)
    cn <- cn + 1;
  }
}
DiscoveryAccuracyB <- as.data.frame(DiscoveryAccuracyB)
colnames(DiscoveryAccuracyB) <- paste("At_",thrvals,sep="")

DiscoverySenB <- as.data.frame(DiscoverySenB)
colnames(DiscoverySenB) <- colnames(DiscoveryAccuracyB)
DiscoverySpeB <- as.data.frame(DiscoverySpeB)
colnames(DiscoverySpeB) <- colnames(DiscoveryAccuracyB)

trainCorB <- as.data.frame(trainCorB)
colnames(trainCorB) <- colnames(DiscoveryAccuracyB)

testCorB <- as.data.frame(testCorB)
colnames(testCorB) <- colnames(DiscoveryAccuracyB)

falseDiscoveryB <- as.data.frame(falseDiscoveryB)
colnames(falseDiscoveryB) <- colnames(DiscoveryAccuracyB)


rotSparcityB <- as.data.frame(rotSparcityB)
colnames(rotSparcityB) <- colnames(DiscoveryAccuracyB)
rotSparcityB <- cbind(rotSparcityB,True=trueSpacity)
par(cex=0.8,cex.main=0.85,cex.axis=0.9)

boxplot(DiscoveryAccuracyB,main="Accuracy",ylab="Accuracy",ylim=c(0.5,1))
boxplot(DiscoverySenB,main="Sensitivity",ylab="Sensitivity",ylim=c(0,1))
boxplot(DiscoverySpeB,main="Specificity",ylab="Specificity",ylim=c(0,1))
boxplot(0.5*(DiscoverySpeB+DiscoverySenB),main="Balanced Accuracy",ylab="BACC",ylim=c(0.5,1))
boxplot(falseDiscoveryB,main="False Discoveries",ylab="Number of False Discoveries")
boxplot(rotSparcityB,main="Rotation Matrix Sparcity",ylab="Sparcity")

ylim <- c(thrvals[1],thrvals[length(thrvals)])
boxplot(trainCorB,main="Train Correlation",ylab="Correlation")
lines(c(1,length(thrvals)),ylim)
boxplot(testCorB,main="Test Correlation",ylab="Correlation")
lines(c(1,length(thrvals)),ylim)

allSen <- cbind(DiscoverySen,DiscoverySenB)
unsortednames <- c(colnames(DiscoverySen),paste(colnames(DiscoverySen),"B",sep="_"))
colnames(allSen) <- unsortednames
ordernames <- colnames(allSen)[order(colnames(allSen))]
allSen <- allSen[ordernames]
vioplot(allSen,col=c("red","blue"))

allSpe <- cbind(DiscoverySpe,DiscoverySpeB)
colnames(allSpe) <- unsortednames
allSpe <- allSpe[ordernames]
vioplot(allSpe,col=c("red","blue"))

allBACC <- cbind(0.5*(DiscoverySpe+DiscoverySen),0.5*(DiscoverySpeB+DiscoverySenB))
colnames(allBACC) <- unsortednames
allBACC <- allBACC[ordernames]
vioplot(allBACC,col=c("red","blue"))


```


### Testing the effect of the number of random features
```{r results = "asis", warning = FALSE, dpi=300, fig.height= 5.0, fig.width= 7.0}


randomToCorrelRatios <- c(1,10,100)
NUmberofSimulations <- 30

falseDiscoveryR <- matrix(0,nrow=NUmberofSimulations,ncol=length(randomToCorrelRatios))
DiscoveryAccuracyR <- falseDiscoveryR
DiscoverySenR <- falseDiscoveryR
DiscoverySpeR <- falseDiscoveryR
trainCorR <- falseDiscoveryR
testCorR <- falseDiscoveryR
thr <- 0.4

i = 1
cn <- 1;
rToCRatio <- 40
for (rToCRatio in randomToCorrelRatios)
{
  for (i in 1:NUmberofSimulations)
  {
    cat(".")
    if (i %% 10 == 0) cat("\n")
    syndata <- SyntheticData(NumOfObs=NumOfObs,NumOfCorFeatures=NumOfCorFeatures,randomToCorrelRatio=rToCRatio,pOfnoZero=-pOfnoZero)
    
    trainSample <- sample(NumOfObs,NumOfObs/2)
    evalILAA <- ILAAEvaluation(traindata=syndata$data[trainSample,],
                                   testdata=syndata$data[-trainSample,],
                                   trueRotation=syndata$rotMatrix,
                                   method=method,
                                   Bootstrap=0,
                                   thr=thr)
    
    trainCorR[i,cn] <- evalILAA$trainCorrelation
    testCorR[i,cn] <- evalILAA$testCorrelation
    falseDiscoveryR[i,cn] <- evalILAA$falseDiscovery
    DiscoveryAccuracyR[i,cn] <- evalILAA$DiscoveryAccuracy
    DiscoverySenR[i,cn] <- evalILAA$DiscoverySen
    DiscoverySpeR[i,cn] <- evalILAA$DiscoverySpe

  }
  cn <- cn + 1;
}


DiscoveryAccuracyR <- as.data.frame(DiscoveryAccuracyR)
colnames(DiscoveryAccuracyR) <- paste("At_",randomToCorrelRatios,sep="")

DiscoverySenR <- as.data.frame(DiscoverySenR)
colnames(DiscoverySenR) <- colnames(DiscoveryAccuracyR)

DiscoverySpeR <- as.data.frame(DiscoverySpeR)
colnames(DiscoverySpeR) <- colnames(DiscoveryAccuracyR)

testCorR <- as.data.frame(testCorR)
colnames(testCorR) <- colnames(DiscoveryAccuracyR)

falseDiscoveryR <- as.data.frame(falseDiscoveryR)
colnames(falseDiscoveryR) <- colnames(DiscoveryAccuracyR)

par(cex=0.8,cex.main=0.85,cex.axis=0.9)

boxplot(DiscoveryAccuracyR,main="Accuracy",ylab="Accuracy")
boxplot(DiscoverySenR,main="Sensitivity",ylab="Sensitivity")
boxplot(DiscoverySpeR,main="Specificity",ylab="Specificity")
boxplot(testCorR,main="Test Correlation",ylab="Correlation")
boxplot(falseDiscoveryR,main="False Discoveries",ylab="Number of False Discoveries")

```
